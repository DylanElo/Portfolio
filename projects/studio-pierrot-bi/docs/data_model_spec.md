# Data Model Specification: Star Schema

## 1. Overview
The data warehouse is designed as a **Star Schema** to optimize query performance for the BI dashboard. It centers on fact tables containing metrics (ratings, revenue) linked to dimension tables containing descriptive attributes (anime details, dates).

## 2. Schema Diagram
```mermaid
erDiagram
    FACT_RATING_SNAPSHOT }|..|| DIM_ANIME : "relates to"
    FACT_RATING_SNAPSHOT }|..|| DIM_DATE : "captured on"
    FACT_REVENUE_STREAM }|..|| DIM_ANIME : "generated by"
    FACT_REVENUE_STREAM }|..|| DIM_DATE : "accrued on"
    FACT_REVENUE_STREAM }|..|| DIM_REGION : "from market"
    DIM_ANIME {
        int anime_id PK
        string title
        string studio
        string revenue_profile
        string broadcast_status
    }
    FACT_RATING_SNAPSHOT {
        int snapshot_id PK
        int anime_id FK
        float score
        int members
        int favorites
    }
```

## 3. Dimension Tables

### `dim_anime`
- **Description:** Master list of anime titles.
- **Key Fields:**
    - `anime_id` (PK): Unique identifier.
    - `title`: Official English title.
    - `studio`: Primary animation studio (e.g., Pierrot, MAPPA).
    - `revenue_profile`: Business category (LegacyTail, NewHit, RevivalHit, LongRun).
    - `broadcast_status`: Airing status (Finished, Airing, Hiatus).

### `dim_date`
- **Description:** Calendar dimension for time-series analysis.
- **Key Fields:** `date_id`, `year`, `quarter`, `month`.

## 4. Fact Tables

### `fact_rating_snapshot`
- **Description:** Daily snapshots of MyAnimeList metrics.
- **Key Metrics:** `score` (0-10), `members` (count), `favorites` (count).
- **Grain:** One row per anime per day.

### `fact_revenue_stream`
- **Description:** Simulated revenue data for dashboarding.
- **Key Metrics:** `revenue_amount_usd`.
- **Grain:** One row per anime per year per region.

## 5. Data Flow
1.  **Extract:** JSON from Jikan API.
2.  **Transform:** Python script maps JSON fields to schema columns; assigns `revenue_profile` logic.
3.  **Load:** SQLite `INSERT OR REPLACE` to handle updates.
