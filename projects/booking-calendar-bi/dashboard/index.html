<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Calendar BI Dashboard</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="container">
        <!-- Navigation -->
        <nav class="top-nav">
            <a href="../../../index.html" class="btn-back">&larr; Return to Portfolio</a>
        </nav>

        <header>
            <h1>Booking Calendar BI Dashboard</h1>
            <p class="subtitle">Operational Intelligence: Bookings, Revenue, Clients & Agent Performance</p>
            <p class="pipeline-info">Data pipeline: VBA Export (CSV) &rarr; SQLite (Star Schema) &rarr; Dashboard</p>
        </header>

        <!-- KPI Cards -->
        <div class="kpi-grid">
            <div class="card kpi-card">
                <h3>Total Bookings (Latest Year)</h3>
                <p class="kpi-value" id="kpi-bookings">Loading...</p>
            </div>
            <div class="card kpi-card">
                <h3>Total Revenue</h3>
                <p class="kpi-value" id="kpi-revenue">Loading...</p>
            </div>
            <div class="card kpi-card">
                <h3>Total PAX</h3>
                <p class="kpi-value" id="kpi-pax">Loading...</p>
            </div>
            <div class="card kpi-card">
                <h3>Avg Margin</h3>
                <p class="kpi-value" id="kpi-margin">Loading...</p>
            </div>
            <div class="card kpi-card">
                <h3>Avg Booking Value</h3>
                <p class="kpi-value" id="kpi-avg-value">Loading...</p>
            </div>
        </div>

        <!-- Charts -->
        <div class="charts-grid">

            <!-- Monthly Revenue + Bookings Trend -->
            <div class="card chart-card full-width">
                <h2>Monthly Revenue & Booking Volume</h2>
                <p class="chart-insight"><strong>Insight:</strong> Tracks seasonal demand patterns and revenue
                    trajectory. COVID impact visible in 2020-2021, with recovery and growth from 2022 onwards.</p>
                <div class="chart-container">
                    <canvas id="monthlyTrendChart"></canvas>
                </div>
            </div>

            <!-- Year over Year -->
            <div class="card chart-card">
                <h2>Year-over-Year Performance</h2>
                <p class="chart-insight"><strong>Insight:</strong> Annual revenue and booking growth trajectory,
                    showing post-COVID recovery and business expansion.</p>
                <div class="chart-container">
                    <canvas id="yoyChart"></canvas>
                </div>
            </div>

            <!-- Service Category Breakdown -->
            <div class="card chart-card">
                <h2>Revenue by Service Category</h2>
                <p class="chart-insight"><strong>Insight:</strong> Accommodation drives the highest revenue per
                    booking, while tours lead in volume. Transfer services have the lowest margin.</p>
                <div class="chart-container">
                    <canvas id="serviceChart"></canvas>
                </div>
            </div>

            <!-- Top Clients -->
            <div class="card chart-card full-width">
                <h2>Top 15 Clients by Revenue</h2>
                <p class="chart-insight"><strong>Insight:</strong> Client concentration analysis. Color indicates
                    client type: Agency (blue), Corporate (teal), Individual (orange).</p>
                <div class="chart-container chart-container-lg">
                    <canvas id="clientChart"></canvas>
                </div>
            </div>

            <!-- Agent Performance -->
            <div class="card chart-card">
                <h2>Agent Performance</h2>
                <p class="chart-insight"><strong>Insight:</strong> Revenue generated per agent. Bars show total
                    revenue, line shows average margin percentage.</p>
                <div class="chart-container">
                    <canvas id="agentChart"></canvas>
                </div>
            </div>

            <!-- Destination Performance -->
            <div class="card chart-card">
                <h2>Revenue by Destination</h2>
                <p class="chart-insight"><strong>Insight:</strong> Paris dominates as a destination, but
                    diversification into regional destinations shows healthy portfolio spread.</p>
                <div class="chart-container">
                    <canvas id="destChart"></canvas>
                </div>
            </div>

            <!-- Booking Status -->
            <div class="card chart-card">
                <h2>Booking Status Distribution</h2>
                <p class="chart-insight"><strong>Insight:</strong> Cancellation rate is a key operational metric.
                    High pending ratio may indicate conversion opportunities.</p>
                <div class="chart-container">
                    <canvas id="statusChart"></canvas>
                </div>
            </div>

            <!-- Lead Time -->
            <div class="card chart-card">
                <h2>Booking Lead Time Distribution</h2>
                <p class="chart-insight"><strong>Insight:</strong> How far in advance clients book. Longer lead
                    times typically correlate with higher booking values and group sizes.</p>
                <div class="chart-container">
                    <canvas id="leadTimeChart"></canvas>
                </div>
            </div>

            <!-- Seasonality Heatmap -->
            <div class="card chart-card full-width">
                <h2>Seasonality by Region</h2>
                <p class="chart-insight"><strong>Insight:</strong> Booking volume distribution across months by
                    client region. Useful for staffing and inventory planning.</p>
                <div class="chart-container chart-container-lg">
                    <canvas id="seasonChart"></canvas>
                </div>
            </div>
        </div>

        <footer>
            <p>Data pipeline: Excel VBA &rarr; CSV &rarr; SQLite (Star Schema) &rarr; JSON &rarr; Chart.js</p>
            <p>Also exports to <strong>bookings_flat.csv</strong> for Looker Studio import.</p>
        </footer>
    </div>
    <script src="js/app.js"></script>
</body>

</html>
