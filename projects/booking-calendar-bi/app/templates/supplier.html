<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supplier Drill-Down | Booking Calendar BI</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Booking Calendar BI</h1>
            <p class="subtitle">Supplier / Hotel Daily Drill-Down</p>
            <nav class="dash-nav">
                <a href="/" class="nav-link">Overview</a>
                <a href="/supplier" class="nav-link active">Supplier Drill-Down</a>
            </nav>
        </header>

        <!-- Supplier Filter Bar -->
        <div class="card filter-bar">
            <div class="filter-group filter-group-wide">
                <label for="supplier-select">Supplier / Hotel</label>
                <input type="text" id="supplier-select" placeholder="Type to search (e.g. Park Hotel Tokyo)..."
                       list="supplier-datalist" autocomplete="off">
                <datalist id="supplier-datalist"></datalist>
            </div>
            <div class="filter-group">
                <label for="svc-date-from">From</label>
                <input type="date" id="svc-date-from" value="2024-01-01">
            </div>
            <div class="filter-group">
                <label for="svc-date-to">To</label>
                <input type="date" id="svc-date-to" value="2025-12-31">
            </div>
            <div class="filter-group">
                <label for="svc-type-filter">Service Type</label>
                <select id="svc-type-filter"><option value="">All</option></select>
            </div>
            <button class="btn-apply" id="btn-load">Load</button>
        </div>

        <!-- Supplier KPIs -->
        <div class="kpi-grid" id="supplier-kpis" style="display:none;">
            <div class="card kpi-card">
                <h3>Days with Services</h3>
                <p class="kpi-value" id="skpi-days">--</p>
            </div>
            <div class="card kpi-card">
                <h3>Total Services</h3>
                <p class="kpi-value" id="skpi-services">--</p>
            </div>
            <div class="card kpi-card">
                <h3>Total PAX</h3>
                <p class="kpi-value" id="skpi-pax">--</p>
            </div>
            <div class="card kpi-card">
                <h3>Unique Bookings</h3>
                <p class="kpi-value" id="skpi-bookings">--</p>
            </div>
            <div class="card kpi-card">
                <h3>Avg Services/Day</h3>
                <p class="kpi-value" id="skpi-avg">--</p>
            </div>
            <div class="card kpi-card">
                <h3>Peak Day</h3>
                <p class="kpi-value" id="skpi-peak">--</p>
            </div>
        </div>

        <!-- Charts -->
        <div class="charts-grid" id="supplier-charts" style="display:none;">
            <div class="card chart-card full-width">
                <h2>Daily Services / Rooms Booked</h2>
                <p class="chart-insight"><strong>Use case:</strong> For a hotel, each bar = rooms occupied that day.
                    For a guide company, each bar = guide assignments. Hover for booking details.</p>
                <div class="chart-container chart-container-xl">
                    <canvas id="dailyChart"></canvas>
                </div>
            </div>

            <div class="card chart-card full-width">
                <h2>Monthly Summary</h2>
                <div class="chart-container">
                    <canvas id="monthlySupplierChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Data Table -->
        <div class="card" id="data-table-container" style="display:none;">
            <h2>Daily Detail Table</h2>
            <p class="chart-insight">Scroll for full date range. Weekend days highlighted.</p>
            <div class="table-wrapper">
                <table id="daily-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Day</th>
                            <th>Services</th>
                            <th>PAX</th>
                            <th>Bookings</th>
                            <th>Types</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Empty state -->
        <div class="card empty-state" id="empty-state">
            <h2>Select a Supplier</h2>
            <p>Choose a supplier or hotel from the dropdown above and click <strong>Load</strong>
                to see their daily booking calendar.</p>
            <p>Examples: <em>Park Hotel Tokyo</em>, <em>Japan Guides</em>, <em>MK Kyoto Co., Ltd.</em></p>
        </div>

        <footer>
            <p>Live queries against SQLite star schema (1M+ service records)</p>
        </footer>
    </div>
    <script src="/static/js/supplier.js"></script>
</body>
</html>
